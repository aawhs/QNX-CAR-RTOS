# COEN320-Project

## DISCLAIMER : WE ARE NOT RESPONSIBLE FOR ANY UNAUTHORIZED USAGE OF OUR SOURCE CODE, INCLUDING BUT NOT LIMITED TO ACADEMIC MISCONDUCT SUCH AS PLAIGARISM AND WE DO NOT CONDONE THE USAGE OF OUR SOURCE CODE WITHOUT CONTACTING ONE OF THE TEAM MEMBERS AND REFERENCING OUR SOURCE CODE IN AN OFFICIALLY ACCEPTED MANNER

# How to run
The program has been tested with Momentics 7.1 and the QNX VM generated by Momentics.

1. Copy the dataset-* files from the data directory in this repository to /data/var/tmp of the QNX VM.
2. Run the program on the QNX VM using Momentics
3. The period of a task can be set by entering the period number (1 to 5), a space, and the period value (1 or greater) and pressing enter


# Team
1. Alexander Wolfe 40103773 alexander.wolfe@mail.concordia.ca
2. Ahmed Ali 40102454 ahmed.ali@mail.concordia.ca
3. Tianyang Jin 40045932 tianyang.jin@mail.concordia.ca
4. Karim Rhoualem 26603157 karim.rhoualem@mail.concordia.ca


# Design
The program is made up of separate producer, consumer, and command processor components that are linked together using IPC by the main function in COEN320-Project.cpp.

Init
- Sets up shared memory
- Creates threads for command processor, 5x producer instances, consumer display


Shared memory structure
Byte    Value Stored
0       Task 1 Period (Fuel)
4       Task 2 Period (RPM)
8       Task 3 Period (Coolant Temperature)
12      Task 4 Period (Gear)
16      Task 5 Period (Speed)
20      Task 1 Value (Fuel)
24      Task 2 Value (RPM)
28      Task 3 Value (Coolant Temperature)
32      Task 4 Value (Gear)
36      Task 5 Value (Speed)


NOTE: shared memory filename does not need to be passed if you use appcore:writeSharedMem / appcore::readSharedMem

Command processor(shared_memory_filename)
- runs in thread
- does not sleep, is blocked by waiting for user input
- Prompts user for producer task number (1-5) and new period for that task (1-100)
- Writes the new period to appropriate location of shared memory for that task (overall area is bytes 0 to 19)
- On first startup, set default value of 5s period for all tasks



Producer(data_filename, shared_memory_filename, shared_memory_period_index, shared_memory_value_index)
- runs in thread
- checks getElapsedTimeSeconds and writes appropriate data value for that time to appropriate location of shared memory
- reads next period from appropriate location of shared memory file 
- sleeps period amount


Consumer(shared_memory_filename)
- runs in thread
- Runs periodically with p=1
- reads the 5 variables from shared memory (contiguous 5 floats from byte 20 to 39)
- print out the 5 variables in a nice looking way

Timing
- Done with threads and sleep(period)
- If we wanted to be fancier we could switch to tracking milliseconds and use sleep( (period-elapsed) / 1000)
- Our functions are probably fast enough this doesn't matter



